<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitPlan - Kişisel Fitness Planlayıcı</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tailwind için Özel Renk Konfigürasyonu -->
    <style>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'olive-grove': '#556B2F', // Koyu zeytin yeşili
                        'dusty-oat': '#F3EAD3',  // Açık yulaf beji
                        'olive-dark': '#455727', // Daha koyu yeşil (hover için)
                        'oat-light': '#FAF7F0',  // Kartlar için çok açık bej
                        'text-dark': '#3a3a3a'   // Ana metin rengi
                    },
                    fontFamily: {
                        'sans': ['Inter', 'sans-serif'] // Okunabilir bir font
                    }
                }
            }
        }
    </style>
    
    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome İkonları (Sil butonu için) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="bg-dusty-oat font-sans text-text-dark min-h-screen">

    <!-- Header -->
    <header class="bg-olive-grove text-oat-light p-4 shadow-lg sticky top-0 z-10">
        <div class="container mx-auto max-w-5xl flex justify-between items-center">
            <h1 class="text-3xl font-bold">FitPlan</h1>
            <!-- Kullanıcı ID alanı kaldırıldı -->
        </div>
    </header>

    <!-- Ana İçerik -->
    <main class="container mx-auto max-w-5xl p-4 sm:p-6">

        <!-- Gün Sekmeleri -->
        <nav class="flex flex-wrap justify-center -mb-px space-x-1" id="day-tabs">
            <button data-day="pazartesi" class="day-tab-btn py-3 px-5 text-lg font-semibold rounded-t-lg transition-colors duration-300">Pazartesi</button>
            <button data-day="sali" class="day-tab-btn py-3 px-5 text-lg font-semibold rounded-t-lg transition-colors duration-300">Salı</button>
            <button data-day="carsamba" class="day-tab-btn py-3 px-5 text-lg font-semibold rounded-t-lg transition-colors duration-300">Çarşamba</button>
            <button data-day="persembe" class="day-tab-btn py-3 px-5 text-lg font-semibold rounded-t-lg transition-colors duration-300">Perşembe</button>
            <button data-day="cuma" class="day-tab-btn py-3 px-5 text-lg font-semibold rounded-t-lg transition-colors duration-300">Cuma</button>
            <button data-day="cumartesi" class="day-tab-btn py-3 px-5 text-lg font-semibold rounded-t-lg transition-colors duration-300">Cumartesi</button>
            <button data-day="pazar" class="day-tab-btn py-3 px-5 text-lg font-semibold rounded-t-lg transition-colors duration-300">Pazar</button>
        </nav>

        <!-- İçerik Kartı -->
        <div class="bg-oat-light p-6 sm:p-8 rounded-b-lg rounded-tr-lg shadow-xl w-full">
            
            <!-- Yüklenme Göstergesi Kaldırıldı -->

            <!-- Ana İçerik Alanı (Artık varsayılan olarak görünür) -->
            <div id="main-content">
                <!-- Günün Motivatörü -->
                <div>
                    <h2 class="text-2xl font-bold text-olive-grove mb-3">Günün Motivatörü</h2>
                    <textarea id="motivation-quote" 
                              rows="3" 
                              class="w-full p-3 bg-white border border-olive-grove/30 rounded-lg shadow-inner focus:ring-2 focus:ring-olive-grove focus:outline-none transition-all"
                              placeholder="Bugün seni ne motive ediyor? Buraya yaz..."></textarea>
                    <button id="save-motivation" class="mt-2 py-2 px-4 bg-olive-grove text-oat-light rounded-lg font-semibold shadow-md hover:bg-olive-dark transition-all">
                        Sözü Kaydet
                    </button>
                </div>

                <hr class="my-6 sm:my-8 border-t border-olive-grove/20">

                <!-- Egzersiz Alanı -->
                <div>
                    <h2 class="text-2xl font-bold text-olive-grove mb-4">Günün Egzersizleri</h2>
                    
                    <!-- Egzersiz Ekleme Formu -->
                    <form id="add-exercise-form" class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end p-4 bg-white rounded-lg shadow-md mb-6">
                        <div class="col-span-1 md:col-span-2">
                            <label for="exercise-name" class="block text-sm font-medium text-text-dark">Egzersiz Adı</label>
                            <input type="text" id="exercise-name" required class="mt-1 w-full p-2 border border-olive-grove/30 rounded-lg focus:ring-2 focus:ring-olive-grove focus:outline-none">
                        </div>
                        <div>
                            <label for="exercise-sets" class="block text-sm font-medium text-text-dark">Set</label>
                            <input type="number" id="exercise-sets" min="1" required class="mt-1 w-full p-2 border border-olive-grove/30 rounded-lg focus:ring-2 focus:ring-olive-grove focus:outline-none">
                        </div>
                        <div>
                            <label for="exercise-reps" class="block text-sm font-medium text-text-dark">Tekrar</label>
                            <input type="text" id="exercise-reps" placeholder="örn: 12-10-8" required class="mt-1 w-full p-2 border border-olive-grove/30 rounded-lg focus:ring-2 focus:ring-olive-grove focus:outline-none">
                        </div>
                        <button type="submit" class="md:col-start-4 py-2 px-4 bg-olive-grove text-oat-light rounded-lg font-semibold shadow-md hover:bg-olive-dark transition-all h-10">
                            <i class="fas fa-plus mr-2"></i>Ekle
                        </button>
                    </form>

                    <!-- Egzersiz Listesi -->
                    <div id="exercise-list" class="space-y-3">
                        <!-- Egzersizler buraya dinamik olarak eklenecek -->
                        <!-- Örnek:
                        <div class="flex justify-between items-center p-4 bg-white rounded-lg shadow-sm">
                            <div>
                                <h3 class="font-bold text-lg">Bench Press</h3>
                                <p class="text-sm text-text-dark">4 Set / 12-10-8-8 Tekrar</p>
                            </div>
                            <button class="delete-exercise-btn text-red-500 hover:text-red-700 transition-colors">
                                <i class="fas fa-trash-alt fa-lg"></i>
                            </button>
                        </div>
                        -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Firebase SDK'ları yerine localStorage kullanılacak (Script'i güncelliyoruz) -->
    <script type="module">
        // --- GLOBAL DEĞİŞKENLER ---
        
        // Firebase ile ilgili değişkenler kaldırıldı
        let currentDay = 'pazartesi'; // Başlangıç günü
        
        // --- UI ELEMENTLERİ ---
        const dayTabsContainer = document.getElementById('day-tabs');
        const motivationQuoteEl = document.getElementById('motivation-quote');
        const saveMotivationBtn = document.getElementById('save-motivation');
        const addExerciseForm = document.getElementById('add-exercise-form');
        const exerciseListEl = document.getElementById('exercise-list');
        // userIdDisplay, loadingSpinner ve mainContent (gizleme mantığı) kaldırıldı

        // --- UYGULAMA MANTIĞI ---

        /**
         * Belirtilen gün için localStorage'dan veriyi çeker.
         */
        function getDayData(day) {
            const key = `fitPlan_${day}`;
            const dataStr = localStorage.getItem(key);
            // Veri yoksa veya bozuksa, varsayılan boş bir yapı döndür
            try {
                const parsedData = JSON.parse(dataStr);
                return parsedData || { motivationQuote: '', exercises: [] };
            } catch (e) {
                return { motivationQuote: '', exercises: [] };
            }
        }

        /**
         * Belirtilen gün için veriyi localStorage'a kaydeder.
         */
        function saveDayData(day, data) {
            const key = `fitPlan_${day}`;
            localStorage.setItem(key, JSON.stringify(data));
        }

        /**
         * Belirli bir günün verilerini localStorage'dan yükler ve UI'ı günceller.
         */
        function loadDataForDay(day) {
            // onSnapshot veya yüklenme mantığı artık yok
            
            const data = getDayData(day);
                
            // Motivasyon sözünü güncelle
            motivationQuoteEl.value = data.motivationQuote;
            
            // Egzersiz listesini render et
            renderExercises(data.exercises);
        }

        /**
         * Egzersiz dizisini alıp HTML listesi olarak ekrana basar.
         */
        function renderExercises(exercises = []) {
            exerciseListEl.innerHTML = ''; // Listeyi temizle
            if (exercises.length === 0) {
                exerciseListEl.innerHTML = '<p class="text-center text-gray-500 italic">Bugün için henüz egzersiz eklenmemiş.</p>';
                return;
            }

            exercises.forEach((ex, index) => {
                const exerciseItem = document.createElement('div');
                exerciseItem.className = 'flex justify-between items-center p-4 bg-white rounded-lg shadow-sm'; // 'animate-fade-in' kaldırıldı (CSS'te tanımlı değilse)
                exerciseItem.innerHTML = `
                    <div>
                        <h3 class="font-bold text-lg text-olive-grove">${ex.name}</h3>
                        <p class="text-sm text-text-dark">${ex.sets} Set / ${ex.reps} Tekrar</p>
                    </div>
                    <button class="delete-exercise-btn text-red-500 hover:text-red-700 transition-colors" data-index="${index}" aria-label="Egzersizi Sil">
                        <i class="fas fa-trash-alt fa-lg"></i>
                    </button>
                `;
                exerciseListEl.appendChild(exerciseItem);
            });
        }
        
        /**
         * Gün sekmesine tıklandığında çalışır. (Bu fonksiyon eksikti)
         */
        function handleTabClick(e) {
            const clickedTab = e.target.closest('.day-tab-btn');
            if (!clickedTab) return;

            const day = clickedTab.dataset.day;
            if (day === currentDay) return; // Zaten bu gündeyiz

            currentDay = day;
            updateActiveTab();
            loadDataForDay(day);
        }

        /**
         * Aktif gün sekmesinin UI'ını günceller. (Bu fonksiyon eksikti)
         */
        function updateActiveTab() {
            document.querySelectorAll('.day-tab-btn').forEach(tab => {
                if (tab.dataset.day === currentDay) {
                    tab.classList.add('bg-oat-light', 'text-olive-grove');
                    tab.classList.remove('text-oat-light', 'opacity-70');
                } else {
                    tab.classList.remove('bg-oat-light', 'text-olive-grove');
                    tab.classList.add('text-oat-light', 'opacity-70', 'hover:opacity-100');
                }
            });
        }

        /**
         * Motivasyon sözünü kaydeder.
         */
        async function saveMotivation() {
            const quote = motivationQuoteEl.value;
            
            try {
                // Mevcut veriyi al, motivasyonu güncelle ve kaydet
                const data = getDayData(currentDay);
                data.motivationQuote = quote;
                saveDayData(currentDay, data);
                
                showCustomMessage("Motivasyon sözü kaydedildi!", "success");
            } catch (error) {
                console.error("Motivasyon sözü kaydedilirken hata: ", error);
                showCustomMessage("Hata: Söz kaydedilemedi.");
            }
        }

        /**
         * Yeni egzersiz ekleme formunu yönetir.
         */
        async function handleAddExercise(e) {
            e.preventDefault();
            const exName = document.getElementById('exercise-name').value;
            const exSets = document.getElementById('exercise-sets').value;
            const exReps = document.getElementById('exercise-reps').value;

            if (!exName || !exSets || !exReps) return;

            const newExercise = {
                name: exName,
                sets: exSets,
                reps: exReps
            };

            try {
                // Mevcut veriyi al
                const data = getDayData(currentDay);
                
                // Yeni egzersizi mevcut diziye ekle
                data.exercises.push(newExercise);
                
                // Veriyi localStorage'a geri kaydet
                saveDayData(currentDay, data);
                
                // UI'ı manuel olarak güncelle (onSnapshot yok)
                renderExercises(data.exercises);
                
                addExerciseForm.reset(); // Formu temizle
            } catch (error) {
                console.error("Egzersiz eklenirken hata: ", error);
                showCustomMessage("Hata: Egzersiz eklenemedi.");
            }
        }

        /**
         * Egzersiz listesindeki silme butonu tıklamalarını yönetir.
         */
        async function handleListClick(e) {
            const deleteBtn = e.target.closest('.delete-exercise-btn');
            if (!deleteBtn) return;

            const indexToDelete = parseInt(deleteBtn.dataset.index);

            try {
                const data = getDayData(currentDay);

                if (!data || !data.exercises) return;

                // İstenen indeksi çıkararak yeni bir dizi oluştur
                const updatedExercises = data.exercises.filter((_, i) => i !== indexToDelete);
                
                // Veriyi güncelle
                data.exercises = updatedExercises;
                
                // localStorage'a kaydet
                saveDayData(currentDay, data);

                // UI'ı manuel olarak güncelle
                renderExercises(updatedExercises);
                
            } catch (error) {
                console.error("Egzersiz silinirken hata: ", error);
                showCustomMessage("Hata: Egzersiz silinemedi.");
            }
        }

        /**
         * Ekranda geçici bir bildirim mesajı gösterir. (Bu fonksiyon eksikti)
         */
        function showCustomMessage(message, type = "error") {
            const msgBox = document.createElement('div');
            msgBox.textContent = message;
            msgBox.className = `fixed bottom-5 right-5 p-4 rounded-lg shadow-xl text-white ${type === 'success' ? 'bg-green-600' : 'bg-red-600'}`;
            document.body.appendChild(msgBox);
            setTimeout(() => {
                msgBox.remove();
            }, 3000);
        }

        /**
         * Firebase Authentication işlemi kaldırıldı.
         */

        // --- BAŞLANGIÇ ---
        document.addEventListener('DOMContentLoaded', () => {
            // Firebase ile ilgili tüm kodlar kaldırıldı
            
            // UI event listener'larını ayarla
            dayTabsContainer.addEventListener('click', handleTabClick);
            saveMotivationBtn.addEventListener('click', saveMotivation);
            addExerciseForm.addEventListener('submit', handleAddExercise);
            exerciseListEl.addEventListener('click', handleListClick);

            // Başlangıç gününü yükle
            updateActiveTab();
            loadDataForDay(currentDay);
        });

    </script>
</body>
</html>
